
```

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         SECURE IMAGE PROMOTION PIPELINE                         â”‚
â”‚                        (Immutable Images + Hash Consistency)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Developer      â”‚    â”‚   Feature        â”‚    â”‚  Main Branch    â”‚
â”‚  Commits Code   â”‚â”€â”€â”€â–¶â”‚   Branch PR      â”‚â”€â”€â”€â–¶â”‚  Merge Trigger  â”‚
â”‚                 â”‚    â”‚  + Dockerfile    â”‚    â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                        â”‚
                                                        â–¼
                                               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                               â”‚  BUILD ONCE     â”‚
                                               â”‚  CI Pipeline    â”‚
                                               â”‚  â€¢ Unit Tests   â”‚
                                               â”‚  â€¢ Build Image  â”‚
                                               â”‚  â€¢ Generate     â”‚
                                               â”‚    SHA256 Hash  â”‚
                                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                        â”‚
                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                       â”‚                 GOLDEN IMAGE CREATION                           â”‚
                       â”‚                                â”‚                                â”‚
                       â–¼                                â–¼                                â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  STAGE 1        â”‚              â”‚  STAGE 2        â”‚              â”‚  STAGE 3        â”‚
            â”‚  Initial Scan   â”‚              â”‚  Deep Security  â”‚              â”‚  Final Approval â”‚
            â”‚  â€¢ Trivy SAST   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚  â€¢ Aqua Full    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚  â€¢ Compliance   â”‚
            â”‚  â€¢ Basic CVE    â”‚              â”‚  â€¢ Malware      â”‚              â”‚  â€¢ Sign Image   â”‚
            â”‚  â€¢ Secrets      â”‚              â”‚  â€¢ Compliance   â”‚              â”‚  â€¢ Attestation  â”‚
            â”‚  â€¢ License      â”‚              â”‚  â€¢ SBOM Gen     â”‚              â”‚  â€¢ Provenance   â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚                                â”‚                                â”‚
                     â–¼                                â–¼                                â–¼
               [SCAN PASSED]                   [DEEP SCAN PASSED]                [APPROVED]
                     â”‚                                â”‚                                â”‚
                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                      â”‚
                                                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            GOLDEN REGISTRY                                     â”‚
â”‚                     (Single Source of Truth)                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ† GOLDEN ECR/ARTIFACTORY                                                    â”‚
â”‚  registry.company.com/app-name:1.2.3                                          â”‚
â”‚  â””â”€ SHA256: a1b2c3d4e5f6...                                                   â”‚
â”‚  â””â”€ Signed: âœ“ (Cosign)                                                        â”‚
â”‚  â””â”€ Scanned: âœ“ (Aqua + Trivy)                                                 â”‚
â”‚  â””â”€ SBOM: âœ“ (Attached)                                                        â”‚
â”‚  â””â”€ Attestation: âœ“ (SLSA Level 3)                                             â”‚
â”‚  â””â”€ Compliance: âœ“ (CIS, NIST, PCI)                                            â”‚
â”‚                                                                               â”‚
â”‚  ğŸ“‹ IMMUTABLE TAGS:                                                           â”‚
â”‚  â€¢ registry.company.com/app-name:1.2.3                                        â”‚
â”‚  â€¢ registry.company.com/app-name:sha256-a1b2c3d4e5f6...                       â”‚
â”‚  â€¢ registry.company.com/app-name:latest-secure                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          KARGO PROMOTION PIPELINE                              â”‚
â”‚                     (Same Hash Across All Environments)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                               â”‚
â”‚  DEV ENVIRONMENT          STAGING ENVIRONMENT         PRODUCTION ENVIRONMENT  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ Auto Promotion  â”‚â”€â”€â”€â”€â”€â–¶â”‚ Auto Promotion  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ Manual Gate     â”‚     â”‚
â”‚  â”‚                 â”‚      â”‚                 â”‚         â”‚                 â”‚     â”‚
â”‚  â”‚ Image:          â”‚      â”‚ Image:          â”‚         â”‚ Image:          â”‚     â”‚
â”‚  â”‚ SHA: a1b2c3d4   â”‚      â”‚ SHA: a1b2c3d4   â”‚         â”‚ SHA: a1b2c3d4   â”‚     â”‚
â”‚  â”‚ âœ“ Same Hash     â”‚      â”‚ âœ“ Same Hash     â”‚         â”‚ âœ“ Same Hash     â”‚     â”‚
â”‚  â”‚                 â”‚      â”‚                 â”‚         â”‚                 â”‚     â”‚
â”‚  â”‚ Tests:          â”‚      â”‚ Tests:          â”‚         â”‚ Validations:    â”‚     â”‚
â”‚  â”‚ â€¢ Unit Tests    â”‚      â”‚ â€¢ E2E Tests     â”‚         â”‚ â€¢ Approval      â”‚     â”‚
â”‚  â”‚ â€¢ Smoke Tests   â”‚      â”‚ â€¢ Perf Tests    â”‚         â”‚ â€¢ Canary Ready  â”‚     â”‚
â”‚  â”‚ â€¢ Runtime Scan  â”‚      â”‚ â€¢ Security Test â”‚         â”‚ â€¢ Rollback Plan â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚         â”‚                          â”‚                          â”‚               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                          â”‚                          â”‚
          â–¼                          â–¼                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   K3S/K8S       â”‚        â”‚   K3S/K8S       â”‚        â”‚   EKS/K8S       â”‚
â”‚   DEV CLUSTER   â”‚        â”‚  STAGE CLUSTER  â”‚        â”‚  PROD CLUSTER   â”‚
â”‚                 â”‚        â”‚                 â”‚        â”‚                 â”‚
â”‚ Pulls Image:    â”‚        â”‚ Pulls Image:    â”‚        â”‚ Pulls Image:    â”‚
â”‚ SHA: a1b2c3d4   â”‚        â”‚ SHA: a1b2c3d4   â”‚        â”‚ SHA: a1b2c3d4   â”‚
â”‚ FROM: Golden    â”‚        â”‚ FROM: Golden    â”‚        â”‚ FROM: Golden    â”‚
â”‚ Registry        â”‚        â”‚ Registry        â”‚        â”‚ Registry        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                          â”‚                          â”‚
          â–¼                          â–¼                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ARGOCD DEPLOYMENT                                       â”‚
â”‚                    (Hash Verification & Drift Detection)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚ DEV ArgoCD      â”‚    â”‚ STAGING ArgoCD  â”‚    â”‚ PROD ArgoCD     â”‚            â”‚
â”‚  â”‚ â€¢ Sync Policy   â”‚    â”‚ â€¢ Sync Policy   â”‚    â”‚ â€¢ Sync Policy   â”‚            â”‚
â”‚  â”‚ â€¢ Hash Check    â”‚    â”‚ â€¢ Hash Check    â”‚    â”‚ â€¢ Hash Check    â”‚            â”‚
â”‚  â”‚ â€¢ Auto Heal     â”‚    â”‚ â€¢ Auto Heal     â”‚    â”‚ â€¢ Manual Sync   â”‚            â”‚
â”‚  â”‚ â€¢ Prune         â”‚    â”‚ â€¢ Prune         â”‚    â”‚ â€¢ Backup Before â”‚            â”‚
â”‚  â”‚                 â”‚    â”‚                 â”‚    â”‚ â€¢ Blue/Green    â”‚            â”‚
â”‚  â”‚ Expected SHA:   â”‚    â”‚ Expected SHA:   â”‚    â”‚ Expected SHA:   â”‚            â”‚
â”‚  â”‚ a1b2c3d4e5f6    â”‚    â”‚ a1b2c3d4e5f6    â”‚    â”‚ a1b2c3d4e5f6    â”‚            â”‚
â”‚  â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚            â”‚
â”‚  â”‚ Actual SHA:     â”‚    â”‚ Actual SHA:     â”‚    â”‚ Actual SHA:     â”‚            â”‚
â”‚  â”‚ a1b2c3d4e5f6 âœ“  â”‚    â”‚ a1b2c3d4e5f6 âœ“  â”‚    â”‚ a1b2c3d4e5f6 âœ“  â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        RUNTIME SECURITY LAYER                                   â”‚
â”‚                      (Continuous Image Validation)                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ Aqua Enforcer   â”‚  â”‚ Image Validator â”‚  â”‚ Admission Ctrl  â”‚               â”‚
â”‚  â”‚ â€¢ Runtime Check â”‚  â”‚ â€¢ SHA256 Verify â”‚  â”‚ â€¢ Policy Check  â”‚               â”‚
â”‚  â”‚ â€¢ Drift Monitor â”‚  â”‚ â€¢ Signature Val â”‚  â”‚ â€¢ Image Source  â”‚               â”‚
â”‚  â”‚ â€¢ Compliance    â”‚  â”‚ â€¢ Registry Auth â”‚  â”‚ â€¢ Hash Match    â”‚               â”‚
â”‚  â”‚ â€¢ Behavior      â”‚  â”‚ â€¢ SBOM Verify   â”‚  â”‚ â€¢ Attestation   â”‚               â”‚
â”‚  â”‚                 â”‚  â”‚                 â”‚  â”‚                 â”‚               â”‚
â”‚  â”‚ Running SHA:    â”‚  â”‚ Expected SHA:   â”‚  â”‚ Allowed SHA:    â”‚               â”‚
â”‚  â”‚ a1b2c3d4e5f6 âœ“  â”‚  â”‚ a1b2c3d4e5f6 âœ“  â”‚  â”‚ a1b2c3d4e5f6 âœ“  â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CONTINUOUS MONITORING & VALIDATION                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ Image Tracking  â”‚  â”‚ Vulnerability   â”‚  â”‚ Compliance      â”‚               â”‚
â”‚  â”‚ â€¢ Hash History  â”‚  â”‚ â€¢ New CVEs      â”‚  â”‚ â€¢ Policy Drift  â”‚               â”‚
â”‚  â”‚ â€¢ Deployment    â”‚  â”‚ â€¢ CVSS Scores   â”‚  â”‚ â€¢ Benchmark     â”‚               â”‚
â”‚  â”‚ â€¢ Rollback      â”‚  â”‚ â€¢ Patch Avail   â”‚  â”‚ â€¢ Attestation   â”‚               â”‚
â”‚  â”‚ â€¢ Audit Trail   â”‚  â”‚ â€¢ Risk Score    â”‚  â”‚ â€¢ Cert Expiry   â”‚               â”‚
â”‚  â”‚                 â”‚  â”‚                 â”‚  â”‚                 â”‚               â”‚
â”‚  â”‚ All Envs SHA:   â”‚  â”‚ Current Risk:   â”‚  â”‚ Compliance:     â”‚               â”‚
â”‚  â”‚ a1b2c3d4e5f6 âœ“  â”‚  â”‚ Low (Score: 2)  â”‚  â”‚ 98% (Passing)   â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           RENOVATION CYCLE                                     â”‚
â”‚                    (Automated Security Updates)                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚ Renovate Bot    â”‚â”€â”€â”€â”€â”€ Triggers â”€â”€â”€â”€â–¶â”‚ New Build       â”‚                   â”‚
â”‚  â”‚ â€¢ Base Image    â”‚                    â”‚ â€¢ New SHA       â”‚                   â”‚
â”‚  â”‚ â€¢ Dependencies  â”‚                    â”‚ â€¢ Security Scan â”‚                   â”‚
â”‚  â”‚ â€¢ CVE Patches   â”‚                    â”‚ â€¢ New Golden    â”‚                   â”‚
â”‚  â”‚ â€¢ Auto PR       â”‚                    â”‚ â€¢ Replaces Old  â”‚                   â”‚
â”‚  â”‚                 â”‚                    â”‚                 â”‚                   â”‚
â”‚  â”‚ Detected:       â”‚                    â”‚ New SHA:        â”‚                   â”‚
â”‚  â”‚ â€¢ CVE-2024-1234 â”‚                    â”‚ b2c3d4e5f6a1    â”‚                   â”‚
â”‚  â”‚ â€¢ High Severity â”‚                    â”‚ â€¢ Secure        â”‚                   â”‚
â”‚  â”‚ â€¢ Patch Avail   â”‚                    â”‚ â€¢ Tested        â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                                  â”‚                            â”‚
â”‚                                                  â–¼                            â”‚
â”‚                                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚                                         â”‚ Automatic       â”‚                   â”‚
â”‚                                         â”‚ Propagation     â”‚                   â”‚
â”‚                                         â”‚ â€¢ Dev First     â”‚                   â”‚
â”‚                                         â”‚ â€¢ Staging Test  â”‚                   â”‚
â”‚                                         â”‚ â€¢ Prod Approval â”‚                   â”‚
â”‚                                         â”‚ â€¢ Same SHA      â”‚                   â”‚
â”‚                                         â”‚ â€¢ Zero Downtime â”‚                   â”‚
â”‚                                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

```mermaid
flowchart TD
    A[ğŸ‘¨â€ğŸ’» Developer] --> B[ğŸ”€ Git Push]
    B --> C[ğŸ—ï¸ CI/CD Build]
    C --> D[ğŸ”’ Security Scan]
    D --> E[ğŸ† Golden Registry<br/>SHA: abc123...]
    
    E --> F[ğŸš€ Kargo Promotion]
    F --> G[ğŸ”§ Dev<br/>SHA: abc123...]
    G --> H[ğŸ¯ Staging<br/>SHA: abc123...]
    H --> I[ğŸ­ Production<br/>SHA: abc123...]
    
    I --> J[ğŸ¯ ArgoCD Deploy]
    J --> K[ğŸ›¡ï¸ Runtime Security]
    K --> L[ğŸ“Š Monitoring]
    
    M[ğŸ”„ Renovate] --> B
    L --> M
    
    %% Same Hash Emphasis
    N[ğŸ”‘ Same SHA256 Hash<br/>Across All Environments] 
    G -.-> N
    H -.-> N
    I -.-> N
    
    %% Security Gates
    O[ğŸ›¡ï¸ Multi-Stage Security]
    D --> O
    O --> |Stage 1: Quick Scan| P[ğŸ“Š Trivy + Secrets]
    O --> |Stage 2: Deep Scan| Q[ğŸ”¬ Aqua + Compliance]
    O --> |Stage 3: Approval| R[ğŸ‘¤ Manual + Signing]
    
    P --> E
    Q --> E
    R --> E
    
    classDef golden fill:#ffd700,stroke:#333,stroke-width:3px
    classDef security fill:#ff9999,stroke:#333,stroke-width:2px
    classDef environment fill:#99ccff,stroke:#333,stroke-width:2px
    classDef hash fill:#90EE90,stroke:#333,stroke-width:2px
    
    class E golden
    class D,K,O,P,Q,R security
    class G,H,I,J environment
    class N hash
```


```mermaid
flowchart TD
  %% === SECTION: DEV & CI ===
  A1[ğŸ‘¨â€ğŸ’» Developer Commits Code] --> A2[ğŸ”€ Feature Branch PR<br/>+ Dockerfile]
  A2 --> A3[ğŸ“¥ Merge to Main<br/>Triggers CI]

  A3 --> B1[ğŸ—ï¸ CI Pipeline:<br/>â€¢ Unit Tests<br/>â€¢ Build Image<br/>â€¢ Generate SHA256]

  %% === SECTION: MULTI-STAGE SECURITY ===
  B1 --> C1[ğŸ” Stage 1: Trivy<br/>â€¢ SAST, CVEs, Secrets, License]
  C1 --> C2[ğŸ§ª Stage 2: Aqua<br/>â€¢ Malware, Compliance, SBOM]
  C2 --> C3[âœ… Stage 3: Approval<br/>â€¢ Manual Sign + Attestation]

  C3 --> D1[ğŸ† Golden Registry<br/>registry.company.com/app:1.2.3<br/>SHA: a1b2c3d4...<br/>Signed: âœ“, Scanned: âœ“, SBOM: âœ“]

  %% === SECTION: PROMOTION PIPELINE ===
  D1 --> E1[ğŸš€ Kargo Promote to DEV<br/>SHA: a1b2c3d4...<br/>â€¢ Unit, Smoke, Runtime Scan]
  E1 --> E2[ğŸš€ Promote to STAGING<br/>SHA: a1b2c3d4...<br/>â€¢ E2E, Perf, Security]
  E2 --> E3[ğŸ›‘ Manual Gate to PROD<br/>SHA: a1b2c3d4...<br/>â€¢ Approval, Canary, Rollback Plan]

  %% === SECTION: CLUSTER DEPLOYMENTS ===
  E1 --> F1[â˜¸ï¸ DEV K3s Pull<br/>FROM Golden<br/>SHA: a1b2c3d4...]
  E2 --> F2[â˜¸ï¸ STAGE K3s Pull<br/>FROM Golden<br/>SHA: a1b2c3d4...]
  E3 --> F3[â˜¸ï¸ PROD EKS Pull<br/>FROM Golden<br/>SHA: a1b2c3d4...]

  %% === SECTION: ARGOCD ===
  F1 --> G1[ğŸ¤– ArgoCD DEV<br/>â€¢ Auto Sync, Hash Check<br/>Expected SHA: a1b2c3d4...]
  F2 --> G2[ğŸ¤– ArgoCD STAGE<br/>â€¢ Auto Sync, Hash Check<br/>Expected SHA: a1b2c3d4...]
  F3 --> G3[ğŸ¤– ArgoCD PROD<br/>â€¢ Manual Sync, Backup<br/>Expected SHA: a1b2c3d4...]

  %% === SECTION: RUNTIME SECURITY ===
  G1 --> H1[ğŸ›¡ï¸ Aqua Enforcer<br/>â€¢ Runtime Check, Drift<br/>Running SHA: a1b2c3d4...]
  G2 --> H2[ğŸ” Validator<br/>â€¢ Signature, Attestation, SBOM]
  G3 --> H3[âœ… Admission Ctrl<br/>â€¢ Policy & Source Check<br/>Allowed SHA: a1b2c3d4...]

  %% === SECTION: MONITORING ===
  H1 --> I1[ğŸ“Š Monitoring:<br/>â€¢ Image History, CVEs<br/>â€¢ Risk Score: Low<br/>â€¢ Compliance: 98%]
  H2 --> I1
  H3 --> I1

  %% === SECTION: RENOVATE ===
  I1 --> J1[ğŸ”„ Renovate Bot<br/>â€¢ CVE-2024-1234, Patch Available]
  J1 --> J2[ğŸ” Auto PR + New Build<br/>New SHA: b2c3d4e5...]

  J2 --> B1

```
