
# CVE-2025-2336

**AngularJS `ngSanitize` SVG Image Sanitization Bypass**

---

## 1. Executive Summary

**CVE-2025-2336** is a vulnerability in AngularJSâ€™s **`ngSanitize` module** that allows attackers to bypass configured image source restrictions for **SVG `<image>` elements**. 
Improper sanitization of the `href` and `xlink:href` attributes enables **content spoofing**, **UI deception**, and **resource abuse**.

Because **AngularJS is End-of-Life (EOL)**, this vulnerability is **permanent**. There is **no patch**, only mitigations or migration.

---

## 2. Affected Components

| Component           | Details                   |
| ------------------- | ------------------------- |
| Package             | `angular-sanitize`        |
| Ecosystem           | npm                       |
| Vulnerable Versions | `>= 1.3.1` and `<= 1.8.3` |
| Patched Versions    | âŒ None                   |
| Project Status      | End-of-Life               |

---

## 3. Root Cause Analysis (Technical)

### Root Cause

When SVG support is enabled:

```js
$sanitizeProvider.enableSvg(true);
```

AngularJSâ€™s `$sanitize` service:

* **Fails to enforce image source restrictions**
* Does **not correctly apply**:

  ```js
  $compileProvider.imgSrcSanitizationTrustedUrlList()
  ```
* Allows **unrestricted URLs** in:

  * `href`
  * `xlink:href`
    on SVG `<image>` elements

This breaks the assumption that **sanitized HTML == trusted HTML**.

---

### Vulnerable Functions & Code Paths

Primary:

* `$sanitize`

Secondary (indirect):

* `ngBindHtml`
* `linky` filter
* Any component rendering attacker-controlled HTML via `$sanitize`

---

## 4. Threat Model

### Assets at Risk

* UI integrity
* User trust
* Administrative workflows
* Application availability (performance)

---

### Trust Boundaries

| Boundary                          | Violation |
| --------------------------------- | --------- |
| User input â†’ rendered HTML        | âŒ Broken  |
| Sanitized HTML â†’ trusted UI       | âŒ Broken  |
| Image source policy â†’ enforcement | âŒ Broken  |

---

### Attacker Profile

* Unauthenticated attacker
* Low skill required
* No privileges required
* Remote exploitation

---

### Attacker Goals

| Goal                             | Achieved? |
| -------------------------------- | --------- |
| UI deception / spoofing          | âœ…         |
| Credential harvesting (indirect) | âœ…         |
| Brand / trust abuse              | âœ…         |
| Performance degradation          | âœ…         |
| Code execution                   | âŒ         |

---

## 5. Attack Scenarios

### Scenario 1: Content Spoofing / UI Deception

An attacker injects an SVG image that:

* Mimics login prompts
* Mimics system warnings
* Mimics admin banners

Result:

* Users trust malicious UI
* Phishing without scripts

---

### Scenario 2: Admin Panel Abuse

If attacker-controlled content renders in:

* Admin dashboards
* Moderation queues
* CMS previews

The attacker can:

* Mislead operators
* Obscure real data
* Induce unsafe admin actions

---

### Scenario 3: Performance / Availability Impact

Attacker embeds:

* Extremely large images
* Slow or chained remote URLs

Result:

* UI freezes
* Browser crashes
* Increased bandwidth usage

---

## 6. OWASP Mapping

### OWASP Top 10 (2021 / 2023)

| OWASP Category                                | Relevance                           |
| --------------------------------------------- | ----------------------------------  |
| A03: Injection                                | âš ï¸ HTML injection (non-script)      |
| A05: Security Misconfiguration                | âœ… Improper sanitizer configuration |
| A07: Identification & Authentication Failures | âš ï¸ UI trust abuse                   |
| A08: Software and Data Integrity Failures     | âœ… Untrusted rendering              |
| A10: Server-Side Request Forgery              | âš ï¸ Resource loading abuse           |

---

### OWASP Top 10 (Client-Side / Web)

| Category                 | Match      |
| ------------------------ | ---------  |
| Content Spoofing         | âœ… Primary |
| UI Redressing            | âœ… Partial |
| Trust Boundary Violation | âœ…         |
| Insecure Rendering       | âœ…         |

---

## 7. STRIDE Mapping

| STRIDE Category        | Impact                   |
| ---------------------- | ------------------------ |
| Spoofing               | âœ… UI identity spoofing   |
| Tampering              | âš ï¸ Visual data tampering  |
| Repudiation            | âŒ                        |
| Information Disclosure | âŒ                        |
| Denial of Service      | âš ï¸ Resource abuse         |
| Elevation of Privilege | âŒ                        |

---

## 8. CVSS Breakdown

| Metric               | Value        |
| -------------------- | ------------ |
| Attack Vector        | Network      |
| Attack Complexity    | High         |
| Privileges Required  | None         |
| User Interaction     | None         |
| Scope                | Unchanged    |
| Confidentiality      | None         |
| Integrity            | Low          |
| Availability         | Low          |
| **Overall Severity** | **Moderate** |

---

## 9. Detection & Exposure Indicators

You are vulnerable if:

* AngularJS is present
* `ngSanitize` is used
* SVG support is enabled
* User-supplied HTML is rendered

High-risk contexts:

* Comments
* Markdown
* CMS previews
* Admin dashboards
* Support ticket views

---

## 10. Mitigations

### Short-Term (Risk Reduction)

```js
$sanitizeProvider.enableSvg(false);
```

* Block SVG rendering
* Enforce CSP:

  ```http
  img-src 'self' data:;
  object-src 'none';
  ```

---

### Long-Term (Recommended)

* **Migrate off AngularJS**
* Replace with supported frameworks
* Treat sanitization as **defense-in-depth only**
* Implement strict rendering allowlists

---

## 11. Risk Statement

> The application renders attacker-controlled HTML under the false assumption that `ngSanitize` enforces image source trust boundaries. 
Due to AngularJS being End-of-Life, this vulnerability cannot be patched and presents a permanent risk to UI integrity and application stability.

---

## 12. Bottom Line

* âœ… Real CVE
* âŒ No patch
* âŒ Permanent risk
* ğŸ”¥ AngularJS must be retired, lol

**Any AngularJS application using `ngSanitize` with SVG enabled is inherently unsafe.**


##
##
