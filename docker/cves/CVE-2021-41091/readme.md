

CVE-2021-41091
Published: 4 October 2021

Moby is an open-source project created by Docker to enable software containerization. 
A bug was found in Moby (Docker Engine) where the data directory (typically `/var/lib/docker`) 
contained subdirectories with insufficiently restricted permissions, allowing otherwise unprivileged Linux users to traverse directory contents and execute programs. When containers included executable programs with extended permission bits (such as `setuid`),
unprivileged Linux users could discover and execute those programs. When the UID of an unprivileged Linux user on the host collided with the file owner or group inside a container, the unprivileged Linux user on the host could discover, read, and modify those files. 
This bug has been fixed in Moby (Docker Engine) 20.10.9. Users should update to this version as soon as possible. Running containers should be stopped and restarted for the permissions to be fixed. For users unable to upgrade limit access to the host to trusted users.
Limit access to host volumes to trusted containers.

Notes
Author	Note
sbeattie	
looks to have possibly been introduced in
e908cc39018c015084ffbffbc5703ccba5c2fbb7 (v20.10.3)


Solution(s)

    amazon-linux-ami-2-upgrade-docker amazon-linux-ami-2-upgrade-docker-debuginfo 

References

    https://attackerkb.com/topics/cve-2021-41091
    AL2/ALASDOCKER-2022-017
    AL2/ALASNITRO-ENCLAVES-2022-017
    CVE - 2021-41091





CVE-2021-41091 - advisory for GHSA-3fwx-pjgw-3558
CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:L

Certain versions of Fedora from Fedoraproject contain the following vulnerability:

Moby is an open-source project created by Docker to enable software containerization. A bug was found in Moby (Docker Engine) where the data directory (typically `/var/lib/docker`) contained subdirectories with insufficiently restricted permissions, allowing otherwise unprivileged Linux users to traverse directory contents and execute programs. When containers included executable programs with extended permission bits (such as `setuid`), unprivileged Linux users could discover and execute those programs. When the UID of an unprivileged Linux user on the host collided with the file owner or group inside a container, the unprivileged Linux user on the host could discover, read, and modify those files. This bug has been fixed in Moby (Docker Engine) 20.10.9. Users should update to this version as soon as possible. Running containers should be stopped and restarted for the permissions to be fixed. For users unable to upgrade limit access to the host to trusted users. Limit access to host volumes to trusted containers.

    CVE-2021-41091 has been assigned by URL Logo security-advisories@github.com to track the vulnerability - currently rated as MEDIUM severity.
    
    
